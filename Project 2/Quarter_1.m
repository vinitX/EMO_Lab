clc;
clear;
data=[0,17.7000000000000;5,19.8000000000000;10,20;15,20.2000000000000;20,20.2000000000000;25,19.9000000000000;30,19;35,17.4000000000000;40,15.2000000000000;45,14.6000000000000;50,9.90000000000000;55,9.10000000000000;60,6.70000000000000;65,4.60000000000000;70,2.80000000000000;75,1.70000000000000;80,0.700000000000000;85,0.200000000000000;90,0;95,0.100000000000000;100,0.400000000000000;105,0.900000000000000;110,1.60000000000000;115,2.40000000000000;120,3.50000000000000;125,4.60000000000000;130,6.80000000000000;135,7.80000000000000;140,9.50000000000000;145,11.2000000000000;150,11.4000000000000;155,11.2000000000000;160,11.7000000000000;165,13.5000000000000;170,16.1000000000000;175,17;180,17.7000000000000;185,19;190,19.3000000000000;195,19.1000000000000;200,17.8000000000000;205,16;210,16.5000000000000;215,13.6000000000000;220,12;225,8.80000000000000;230,7;235,6.80000000000000;240,5.50000000000000;245,3.90000000000000;250,2.50000000000000;255,1.20000000000000;260,0.600000000000000;265,0.100000000000000;270,0;275,0.200000000000000;280,0.700000000000000;285,1.30000000000000;290,2.10000000000000;295,2.50000000000000;300,3.40000000000000;305,5;310,6.30000000000000;315,7;320,8.20000000000000;325,8.70000000000000;330,9.40000000000000;335,10.8000000000000;340,11.8000000000000;345,13.6000000000000;350,16.3000000000000;355,16.6000000000000;360,17.7000000000000];
x=data(:,1)*pi/180;
y=data(:,2);
%{
figure()
hold on
scatter(x,y)
%}
F = @(n,x) abs(n(1))+n(2)*cos(x-n(3)).^2;
n0 = [0 20 0];
[n,resnorm,~,exitflag,output] = lsqcurvefit(F,n0,x,y);

e=mean((y-F(n,x)).^2)^0.5;
%{
plot(x,F(n,x))

%plot(x,polyval(p,cos(x).^2))
xlabel('Angle (\theta)');
ylabel('Photocurrent (mA)');
hold off

figure()
polarscatter(x,y,'*')
hold on
polarplot(x,F(n,x))
hold off


figure()
hold on
t=F(n,x);
scatter(t,y)
p=polyfit(t,y,1);
plot(t,polyval(p,t))
xlabel('cos^2(\theta)');
ylabel('Photocurrent (mA)');
hold off
%}